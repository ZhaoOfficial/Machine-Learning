# Chapter 4 å‰é¦ˆç¥ç»ç½‘ç»œ Feed-forward Neural Network 
â€¦â€¦â€¦
## 4.1 ç¥ç»å…ƒ Neuron
ç¥ç»å…ƒæ˜¯ç¥ç»ç½‘ç»œçš„åŸºæœ¬å•å…ƒï¼Œå®ƒæ¥æ”¶ä¸€ç»„è¾“å…¥ä¿¡å·å¹¶äº§ç”Ÿè¾“å‡ºã€‚å‡è®¾ä¸€ä¸ªç¥ç»å…ƒæ¥æ”¶ $D$ ä¸ªè¾“å…¥ $x_1,\dots,x_d$ï¼Œä»¤å‘é‡ $\mathbf x=[x_1;\dots;x_d]$ æ¥è¡¨ç¤ºè¿™ç»„è¾“å…¥ã€‚ç”¨ **å‡€è¾“å…¥**ï¼ˆNet Inputï¼‰$z\in\mathbb R$ è¡¨ç¤ºä¸€ä¸ªç¥ç»å…ƒæ‰€è·å¾—è¾“å…¥ä¿¡å·çš„åŠ æƒå’Œ
$$
\begin{align*}
z&=\sum_{d=1}^{D}w_dx_d+b\\
&=\mathbf w^T\mathbf x+b
\end{align*}
$$
å…¶ä¸­ $\mathbf w=[w_1;\dots;w_d]\in\mathbb R^D$ æ˜¯ $D$ ç»´æƒé‡å‘é‡ï¼Œ$b\in\mathbf R$ æ˜¯åç½®å‘é‡ã€‚

å‡€è¾“å…¥ $z$ ç»è¿‡ä¸€ä¸ª éçº¿æ€§å‡½æ•° $f(\cdot)$ åå¾—åˆ°ç¥ç»å…ƒæ´»æ€§å€¼ï¼ˆActivationï¼‰$a$
$$
a=f(z)
$$
å…¶ä¸­çš„éçº¿æ€§å‡½æ•°ç§°ä¸º**æ¿€æ´»å‡½æ•°**ï¼ˆActivation Functionï¼‰ã€‚

> æ¿€æ´»å‡½æ•°çš„æ€§è´¨  
>
> 1. è¿ç»­ä¸”å¯å¯¼ï¼ˆå…è®¸å°‘æ•°ç‚¹ä¸Šä¸å¯å¯¼ï¼‰çš„éçº¿æ€§å‡½æ•°ã€‚å¯å¯¼çš„æ¿€æ´»å‡½æ•° å¯ä»¥ç›´æ¥åˆ©ç”¨æ•°å€¼ä¼˜åŒ–çš„æ–¹æ³•æ¥å­¦ä¹ ç½‘ç»œå‚æ•°ã€‚
> 2. æ¿€æ´»å‡½æ•°åŠå…¶å¯¼å‡½æ•°è¦å°½å¯èƒ½çš„ç®€å•ï¼Œæœ‰åˆ©äºæé«˜ç½‘ç»œè®¡ç®—æ•ˆç‡ã€‚
> 3. æ¿€æ´»å‡½æ•°çš„å¯¼å‡½æ•°çš„å€¼åŸŸè¦åœ¨ä¸€ä¸ªåˆé€‚çš„åŒºé—´å†…ï¼Œä¸èƒ½å¤ªå¤§ä¹Ÿä¸èƒ½å¤ªå°ï¼Œå¦åˆ™ä¼šå½±å“è®­ç»ƒçš„æ•ˆç‡å’Œç¨³å®šæ€§ã€‚
>

### 4.1.1 Sigmoid å‹å‡½æ•°
Sigmoid å‹å‡½æ•°æ˜¯ä¸€ç±» S å‹æ›²çº¿ã€‚sigmoid å‹å‡½æ•°çš„è¾“å…¥å€¼åœ¨ $0$ é™„è¿‘æ—¶è¿‘ä¼¼ä¸ºçº¿æ€§å‡½æ•°ï¼Œåœ¨è¾“å…¥çš„ç»å¯¹å€¼è¾ƒå¤§çš„æ—¶å€™å¯¹è¾“å…¥è¿›è¡ŒæŠ‘åˆ¶ã€‚
#### Logistic å‡½æ•°
å®šä¹‰ Logistic å‡½æ•°ä¸ºï¼š
$$
\sigma(x)=\frac{1}{1+e^{-x}}\\
\sigma: \mathbb R\to(0,1)
$$
è¾“å…¥è¶Šå°ï¼Œè¶Šæ¥è¿‘äº 0ï¼›è¾“å…¥è¶Šå¤§ï¼Œè¶Šæ¥è¿‘äº 1ã€‚

> Logistic å‡½æ•°çš„æ€§è´¨  
>
> 1. å…¶è¾“å‡ºç›´æ¥å¯ä»¥çœ‹ä½œæ¦‚ç‡åˆ†å¸ƒï¼Œä½¿å¾—ç¥ç»ç½‘ç»œå¯ä»¥æ›´å¥½åœ°å’Œç»Ÿè®¡å­¦ä¹ æ¨¡å‹è¿›è¡Œç»“åˆã€‚
> 2. å…¶å¯ä»¥çœ‹ä½œä¸€ä¸ªè½¯æ€§é—¨(Soft Gate)ï¼Œç”¨æ¥æ§åˆ¶å…¶ä»–ç¥ç»å…ƒè¾“å‡ºä¿¡æ¯çš„æ•°é‡ã€‚
>

#### $\tanh$ å‡½æ•°
å®šä¹‰ $\tanh(x)$ å‡½æ•°ä¸ºï¼š
$$
\tanh(x)=\frac{e^x-e^{-x}}{e^x+e^{-x}}\\
\tanh(x)=2\sigma(2x)-1\\
\tanh: \mathbb R\to(-1,1)
$$
$\tanh$ å‡½æ•°æ˜¯å¥‡å‡½æ•°ï¼Œè€Œ Logistic å‡½æ•°è¾“å‡ºæ’å¤§äºé›¶ã€‚éå¥‡å‡½æ•°ä¼šä½¿å¾—å…¶åä¸€å±‚çš„ç¥ç»å…ƒçš„è¾“å…¥å‘ç”Ÿåç½®åç§»ï¼ˆBias Shiftï¼‰ï¼Œå¹¶è¿›ä¸€æ­¥ä½¿å¾—æ¢¯åº¦ä¸‹é™çš„æ”¶æ•›é€Ÿåº¦å˜æ…¢ã€‚

#### Hard-Logistic å‡½æ•°å’Œ Hard-$\tanh$ å‡½æ•°
Logistic å‡½æ•°å’Œ $\tanh$ å‡½æ•°è®¡ç®—å¼€é”€è¾ƒå¤§ã€‚è€Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯åœ¨ $0$ é™„è¿‘è¿‘ä¼¼çº¿æ€§ï¼Œä¸¤ç«¯é¥±å’Œã€‚å› æ­¤ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°å¯ä»¥é€šè¿‡åœ¨ $0$ å¤„ä¸€é˜¶æ³°å‹’å±•å¼€çš„åˆ†æ®µå‡½æ•°æ¥è¿‘ä¼¼ã€‚
$$
\begin{align*}
\text{hard-logistic}(x)&=\begin{cases}
1&x\ge2\\
0.25x+0.5&-2<x<2\\
0&x\le-2
\end{cases}\\
&=\max(\min(0.25x+0.5,1),0)\\
\text{hard-tanh}(x)&=2\sigma(2x)-1\\
&=\max(\min(x,1),-1)
\end{align*}
$$

![sigmoid](data/sigmoid.png)

### 4.1.2 ReLU å‡½æ•°
ReLUï¼ˆRectified Linear Unitï¼Œä¿®æ­£çº¿æ€§å•å…ƒï¼‰ï¼Œä¹Ÿå« Rectifier å‡½æ•°ï¼Œæ˜¯ç›®å‰æ·±åº¦ç¥ç»ç½‘ç»œä¸­ç»å¸¸ä½¿ç”¨çš„æ¿€æ´»å‡½æ•°ã€‚å®šä¹‰ ReLU ä¸ºï¼š
$$
\text{ReLU}(x)=\max(0,x)
$$
> ä¼˜ç‚¹ï¼š  
>
> 1. è®¡ç®—ä¸Šæ›´å®¹æ˜“é«˜æ•ˆã€‚
> 2. å•ä¾§æŠ‘åˆ¶ã€å®½å…´å¥‹è¾¹ç•Œï¼ˆå³å…´å¥‹ç¨‹åº¦å¯ä»¥éå¸¸é«˜ï¼‰ã€‚
> 3. ReLU å‡½æ•°ä¸ºå·¦é¥±å’Œå‡½æ•°ï¼Œä¸”åœ¨ $x>0$ æ—¶å¯¼æ•°ä¸º $1$ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£äº†ç¥ç»ç½‘ç»œçš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼ŒåŠ é€Ÿæ¢¯åº¦ä¸‹é™çš„æ”¶æ•›é€Ÿåº¦ã€‚
>
> ç¼ºç‚¹ï¼š  
>
> 1. ReLU å‡½æ•°çš„è¾“å‡ºæ˜¯éé›¶ä¸­å¿ƒåŒ–çš„ï¼Œç»™åä¸€å±‚çš„ç¥ç»ç½‘ç»œå¼•å…¥åç½®åç§»ï¼Œä¼šå½±å“æ¢¯åº¦ä¸‹é™çš„æ•ˆç‡ã€‚
> 2. æ­»äº¡ ReLU é—®é¢˜ï¼šéšè—å±‚ä¸­çš„æŸä¸ª ReLU ç¥ç»å…ƒåœ¨æ‰€æœ‰çš„è¾“å…¥ä¸Šéƒ½ä¸èƒ½è¢«æ¿€æ´»ï¼Œé‚£ä¹ˆè¿™ä¸ªç¥ç»å…ƒè‡ªèº«å‚æ•°çš„æ¢¯åº¦æ°¸è¿œéƒ½ä¼šæ˜¯ 0ï¼Œåœ¨ä»¥åçš„è®­ç»ƒè¿‡ç¨‹ä¸­æ°¸è¿œä¸èƒ½è¢«æ¿€æ´»ã€‚

å› æ­¤å‡ºç° ReLU å‡½æ•°çš„å˜ç§ã€‚

#### å¸¦æ³„éœ²çš„ ReLU
å¸¦æ³„éœ²çš„ ReLUï¼ˆLeaky ReLUï¼‰åœ¨è¾“å…¥ $x<0$ æ—¶ï¼Œä¿æŒä¸€ä¸ªå¾ˆå°çš„æ¢¯åº¦ $\gamma$ã€‚è¿™æ ·å½“ç¥ç»å…ƒéæ¿€æ´»æ—¶ä¹Ÿèƒ½æœ‰ä¸€ä¸ªéé›¶çš„æ¢¯åº¦å¯ä»¥æ›´æ–°å‚æ•°ï¼Œé¿å…æ°¸è¿œä¸èƒ½è¢«æ¿€æ´»ã€‚å®šä¹‰ Leaky ReLU ä¸ºï¼š
$$
\begin{align*}
\text{LeakyReLU}(x)&=\max(0,x)+\gamma\min(0,x)\\
&=\max(x,\gamma x)\qquad(\gamma<1)
\end{align*}
$$
#### å¸¦å‚æ•°çš„ ReLU
å¸¦å‚æ•°çš„ ReLUï¼ˆParametric ReLUï¼ŒPReLUï¼‰å¼•å…¥ä¸€ä¸ªå¯å­¦ä¹ çš„å‚æ•°ï¼Œä¸åŒç¥ç»å…ƒå¯ä»¥æœ‰ä¸åŒçš„å‚æ•°ã€‚
$$
\begin{align*}
PReLU(x)&=\max(0,x)+\gamma_i\min(0,x)
\end{align*}
$$
å…¶ä¸­ $\gamma_i$ ä¸º $x\le0$ æ—¶å‡½æ•°çš„æ–œç‡ã€‚
PReLU å¯ä»¥å…è®¸ä¸åŒç¥ç»å…ƒå…·æœ‰ä¸åŒçš„å‚æ•°ï¼Œä¹Ÿå¯ä»¥ä¸€ç»„ç¥ç»å…ƒå…±äº«ä¸€ ä¸ªå‚æ•°ã€‚

#### ELU å‡½æ•°
ELUï¼ˆExponential Linear Unitï¼ŒæŒ‡æ•°çº¿æ€§å•å…ƒï¼‰æ˜¯ä¸€ä¸ªè¿‘ä¼¼çš„é›¶ä¸­å¿ƒåŒ–çš„éçº¿æ€§å‡½æ•°ï¼š
$$
\begin{align}
\text{ELU}(x)&=\max(0,x)+\gamma\min(0,e^x-1)
\end{align}
$$

#### Softplus å‡½æ•°
Softplus å‡½æ•°å¯ä»¥çœ‹ä½œ ReLU å‡½æ•°çš„å¹³æ»‘ç‰ˆæœ¬ï¼Œå…¶å®šä¹‰ä¸ºï¼š
$$
\text{Softplus}(x)=\log(1+e^x)
$$
Softplus å‡½æ•°å…¶å¯¼æ•°åˆšå¥½æ˜¯ Logistic å‡½æ•°ã€‚Softplus å‡½æ•°è™½ç„¶ä¹Ÿå…·æœ‰å•ä¾§æŠ‘åˆ¶ã€å®½å…´å¥‹è¾¹ç•Œçš„ç‰¹æ€§ï¼Œå´æ²¡æœ‰ç¨€ç–æ¿€æ´»æ€§ã€‚

![relu](data/relu.png)

### 4.1.3 Swish å‡½æ•°
Swish å‡½æ•°æ˜¯ä¸€ç§è‡ªé—¨æ§(Self-Gated)æ¿€æ´»å‡½æ•°ï¼š
$$
\text{Swish}(x)=x\sigma(\beta x)
$$
å…¶ä¸­ $\sigma(\cdot)$ ä¸º Logistic å‡½æ•°ï¼Œ$\beta$ ä¸ºå¯å­¦ä¹ çš„å‚æ•°æˆ–ä¸€ä¸ªå›ºå®šè¶…å‚æ•°ã€‚

å½“ $\sigma(\beta x)$ æ¥è¿‘äº $1$ æ—¶ï¼Œé—¨å¤„äºâ€œå¼€â€çŠ¶æ€ï¼Œæ¿€æ´»å‡½æ•°çš„è¾“å‡ºè¿‘ä¼¼äº $x$ æœ¬èº«;å½“$\sigma(\beta x)$ æ¥è¿‘äº $0$ æ—¶ï¼Œé—¨çš„çŠ¶æ€ä¸ºâ€œå…³â€ï¼Œæ¿€æ´»å‡½æ•°çš„è¾“å‡ºè¿‘ä¼¼äº $0$ã€‚

å½“ $\beta=0$ æ—¶ï¼ŒSwish å‡½æ•°å˜æˆçº¿æ€§å‡½æ•° $x/2$ã€‚å½“ $\beta=1$ æ—¶ï¼ŒSwishå‡½æ•°åœ¨ $x>0$ æ—¶è¿‘ä¼¼çº¿æ€§ï¼Œåœ¨ $x<0$ æ—¶è¿‘ä¼¼é¥±å’Œï¼ŒåŒæ—¶å…·æœ‰ä¸€å®šçš„éå•è°ƒæ€§ã€‚å½“ $\beta\to+\infty$ æ—¶ï¼ŒSwish å‡½æ•°è¿‘ä¼¼ä¸º ReLU å‡½æ•°ã€‚å› æ­¤ï¼ŒSwish å‡½æ•°å¯ä»¥çœ‹ä½œçº¿æ€§å‡½æ•°å’Œ ReLU å‡½æ•°ä¹‹é—´çš„éçº¿æ€§æ’å€¼å‡½æ•°ï¼Œå…¶ç¨‹åº¦ç”±å‚æ•° $\beta$ æ§åˆ¶ã€‚

![swish](data/swish.png)

### 4.1.4 GELU å‡½æ•°
GELUï¼ˆGaussian Error Linear Unitï¼Œé«˜æ–¯è¯¯å·®çº¿æ€§å•å…ƒï¼‰ä¹Ÿæ˜¯ä¸€ç§é€šè¿‡é—¨æ§æœºåˆ¶æ¥è°ƒæ•´å…¶è¾“å‡ºå€¼çš„æ¿€æ´»å‡½æ•°ï¼Œå’Œ Swish å‡½æ•°æ¯”è¾ƒç±»ä¼¼ã€‚
$$
\text{GELU}(x)=x\phi(x)=x\int_{-\infty}^{x}\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{(t-\mu)^2}{2\sigma^2}}\ dt
$$
![gelu](data/gelu.png)

### 4.1.5 Maxout å•å…ƒ

Maxout å•å…ƒä¹Ÿæ˜¯ä¸€ç§åˆ†æ®µçº¿æ€§å‡½æ•°ã€‚Maxout å•å…ƒçš„è¾“å…¥æ˜¯ä¸Šä¸€å±‚ç¥ç»å…ƒçš„å…¨éƒ¨åŸå§‹è¾“å‡ºï¼Œæ˜¯ä¸€ä¸ªå‘é‡ $\mathbf x=[x_1;\dots;x_d]$ã€‚æ¯ä¸ª Maxout å•å…ƒæœ‰ $K$ ä¸ªæƒé‡å‘é‡ $\mathbf w_k=[w_1;\dots;w_d]\in\mathbb R^D$ å’Œåç½® $b_k$ã€‚å› æ­¤å¯¹äºè¾“å…¥ $\mathbf x$ï¼Œå¯ä»¥å¾—åˆ° $K$ ä¸ªå‡€è¾“å…¥ $z_k$
$$
z_k=\mathbf w_k^T\mathbf x+b_k
$$
Maxout å•å…ƒçš„éçº¿æ€§å‡½æ•°å®šä¹‰ä¸ºï¼š
$$
\text{maxout}(x)=\max_{k}(z_k)
$$
Maxoutæ¿€æ´»å‡½æ•°å¯ä»¥çœ‹ä½œä»»æ„å‡¸å‡½æ•°çš„åˆ†æ®µçº¿æ€§è¿‘ä¼¼ï¼Œå¹¶ä¸”åœ¨æœ‰é™çš„ç‚¹ä¸Šæ˜¯ä¸å¯å¾®çš„ã€‚

## 4.2 ç½‘ç»œç»“æ„

é€šè¿‡ä¸€å®šçš„è¿æ¥æ–¹å¼æˆ–ä¿¡æ¯ä¼ é€’æ–¹å¼è¿›è¡Œåä½œçš„ç¥ç»å…ƒå¯ä»¥çœ‹ä½œä¸€ä¸ªç½‘ç»œï¼Œå°±æ˜¯*ç¥ç»ç½‘ç»œ*ã€‚

### 4.2.1 å‰é¦ˆç½‘ç»œ

å‰é¦ˆç½‘ç»œä¸­å„ä¸ªç¥ç»å…ƒæŒ‰æ¥æ”¶ä¿¡æ¯çš„å…ˆååˆ†ä¸ºä¸åŒçš„ç»„ï¼æ¯ä¸€ç»„å¯ä»¥çœ‹ä½œä¸€ä¸ªç¥ç»å±‚ï¼æ¯ä¸€å±‚ä¸­çš„ç¥ç»å…ƒæ¥æ”¶å‰ä¸€å±‚ç¥ç»å…ƒçš„è¾“å‡ºï¼Œå¹¶è¾“å‡ºåˆ°ä¸‹ä¸€å±‚ç¥ç»å…ƒã€‚æ•´ä¸ªç½‘ç»œä¸­çš„ä¿¡æ¯æ˜¯æœä¸€ä¸ªæ–¹å‘ä¼ æ’­ï¼Œæ²¡æœ‰åå‘çš„ä¿¡æ¯ä¼ æ’­ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªæœ‰å‘æ— ç¯è·¯å›¾è¡¨ç¤ºã€‚

å‰é¦ˆç½‘ç»œå¯ä»¥çœ‹ä½œä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡ç®€å•éçº¿æ€§å‡½æ•°çš„å¤šæ¬¡å¤åˆï¼Œå®ç°è¾“å…¥ç©ºé—´åˆ°è¾“å‡ºç©ºé—´çš„å¤æ‚æ˜ å°„ã€‚

### 4.2.2 è®°å¿†ç½‘ç»œ

è®°å¿†ç½‘ç»œï¼Œä¹Ÿç§°ä¸ºåé¦ˆç½‘ç»œï¼Œç½‘ç»œä¸­çš„ç¥ç»å…ƒä¸ä½†å¯ä»¥æ¥æ”¶å…¶ä»–ç¥ç»å…ƒçš„ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶è‡ªå·±çš„å†å²ä¿¡æ¯ã€‚è®°å¿†ç¥ç»ç½‘ç»œä¸­çš„ä¿¡æ¯ä¼ æ’­å¯ä»¥æ˜¯å•å‘æˆ–åŒå‘ä¼ é€’ï¼Œå› æ­¤å¯ç”¨ä¸€ä¸ªæœ‰å‘å¾ªç¯å›¾æˆ–æ— å‘å›¾æ¥è¡¨ç¤ºã€‚

### 4.2.3 å›¾ç½‘ç»œ

å›¾ç½‘ç»œæ˜¯å®šä¹‰åœ¨å›¾ç»“æ„æ•°æ®ä¸Šçš„ç¥ç»ç½‘ç»œã€‚å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹éƒ½ç”±ä¸€ä¸ªæˆ–ä¸€ç»„ç¥ç»å…ƒæ„æˆã€‚èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥å¯ä»¥æ˜¯æœ‰å‘çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯æ— å‘çš„ã€‚æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æ”¶åˆ°æ¥è‡ªç›¸é‚»èŠ‚ç‚¹æˆ–è‡ªèº«çš„ä¿¡æ¯ã€‚

## 4.3 å‰é¦ˆç¥ç»ç½‘ç»œ

*å‰é¦ˆç¥ç»ç½‘ç»œ*ï¼ˆFeed-forward Neural Networkï¼ŒFNNï¼‰ä¹Ÿç»å¸¸ç§°ä¸º**å¤šå±‚æ„ŸçŸ¥å™¨**ï¼ˆMulti-Layer Perceptronï¼ŒMLPï¼‰ã€‚ä½†å¤šå±‚æ„ŸçŸ¥å™¨çš„å«æ³•å¹¶ä¸æ˜¯ååˆ†åˆç†ï¼Œå› ä¸ºå‰é¦ˆç¥ç»ç½‘ç»œå…¶å®æ˜¯ç”±å¤šå±‚çš„ Logistic å›å½’æ¨¡å‹ï¼ˆè¿ç»­çš„éçº¿æ€§å‡½æ•°ï¼‰ç»„æˆï¼Œè€Œä¸æ˜¯ç”±å¤šå±‚çš„æ„ŸçŸ¥å™¨ï¼ˆä¸è¿ç»­çš„éçº¿æ€§å‡½æ•°ï¼‰ç»„æˆã€‚

åœ¨å‰é¦ˆç¥ç»ç½‘ç»œä¸­ï¼Œå„ç¥ç»å…ƒåˆ†åˆ«å±äºä¸åŒçš„å±‚ã€‚æ¯ä¸€å±‚çš„ç¥ç»å…ƒå¯ä»¥æ¥æ”¶å‰ä¸€å±‚ç¥ç»å…ƒçš„ä¿¡å·ï¼Œå¹¶äº§ç”Ÿä¿¡å·è¾“å‡ºåˆ°ä¸‹ä¸€å±‚ã€‚ç¬¬ $0$ å±‚ç§°ä¸º**è¾“å…¥å±‚**ï¼Œæœ€åä¸€å±‚ç§°ä¸ºè¾“å‡ºå±‚ï¼Œå…¶ä»–ä¸­é—´å±‚ç§°ä¸º**éšè—å±‚**ã€‚

| è®°å·                                      | æ„ä¹‰                                |
| ----------------------------------------- | ----------------------------------- |
| $L$                                       | ç¥ç»ç½‘ç»œçš„å±‚æ•°                      |
| $M_l$                                     | ç¬¬ $l$ å±‚ç¥ç»å…ƒçš„ä¸ªæ•°               |
| $f_l(\cdot)$                              | ç¬¬ $l$ å±‚ç¥ç»å…ƒçš„æ¿€æ´»å‡½æ•°           |
| $W^{(l)}\in\mathbb R^{M_l\times M_{M-1}}$ | ç¬¬ $l-1$ å±‚åˆ°ç¬¬ $l$ å±‚çš„æƒé‡çŸ©é˜µ    |
| $\mathbf b^{(l)}\in\mathbb R^{M_l}$       | ç¬¬ $l-1$ å±‚åˆ°ç¬¬ $l$ å±‚çš„åç½®        |
| $\mathbf z^{(l)}\in\mathbb R^{M_l}$       | ç¬¬ $l$ å±‚ç¥ç»å…ƒçš„å‡€è¾“å…¥ï¼ˆå‡€æ´»æ€§å€¼ï¼‰ |
| $\mathbf a^{(l)}\in\mathbb R^{M_l}$       | ç¬¬ $l$ å±‚ç¥ç»å…ƒçš„è¾“å‡ºï¼ˆæ´»æ€§å€¼ï¼‰     |

ä»¤ $\mathbf a^{(0)}=\mathbf x$ï¼Œå‰é¦ˆç¥ç»ç½‘ç»œé€šè¿‡ä¸æ–­è¿­ä»£ä¸‹é¢å…¬å¼è¿›è¡Œä¿¡æ¯ä¼ æ’­ï¼š
$$
\begin{align*}
\mathbf z^{(l)}&=W^{(l)}\mathbf a^{(l-1)}+\mathbf b^{(l)}\\
\mathbf a^{(l)}&=f_l(\mathbf z^{(l)})
\end{align*}
$$
æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠæ¯ä¸ªç¥ç»å±‚çœ‹ä½œä¸€ä¸ªä»¿å°„å˜æ¢åŠ ä¸Šä¸€ä¸ªéçº¿æ€§å˜æ¢ã€‚

### 4.3.1 é€šç”¨è¿‘ä¼¼å®šç†

å‰é¦ˆç¥ç»ç½‘ç»œå…·æœ‰å¾ˆå¼ºçš„æ‹Ÿåˆèƒ½åŠ›ï¼Œå¸¸è§çš„è¿ç»­éçº¿æ€§å‡½æ•°éƒ½å¯ä»¥ç”¨å‰é¦ˆç¥ç»ç½‘ç»œæ¥è¿‘ä¼¼ã€‚

> ä»¤ $\phi(\cdot)$ æ˜¯ä¸€ä¸ªéå¸¸æ•°ã€æœ‰ç•Œã€å•è°ƒé€’å¢çš„è¿ç»­å‡½æ•°ï¼Œ$J_D$ æ˜¯ä¸€ä¸ª $D$ ç»´çš„å•ä½è¶…ç«‹æ–¹ä½“ $[0,1]^D$ï¼Œ$C(J^D)$ æ˜¯å®šä¹‰åœ¨ $J_D$ ä¸Šçš„è¿ç»­å‡½æ•°çš„é›†åˆï¼Œå¯¹äºä»»æ„ç»™å®šçš„ä¸€ä¸ªå‡½æ•° $f\in C(J^D)$ï¼Œå­˜åœ¨ä¸€ä¸ªæ•´æ•° $M$ å’Œä¸€ç»„å®æ•° $v_m,b_m\in\mathbb R$ ä»¥åŠå®æ•°å‘é‡ $\mathbf w_m\in\mathbb R^D$ï¼Œä½¿å¾—
> $$
> F(\mathbf x)=\sum_{m=1}^{M}v_m\phi(\mathbf w_m^T\mathbf x+b_m)
> $$
> èƒ½ä½œä¸ºå‡½æ•° $f$ çš„è¿‘ä¼¼ï¼Œå³
> $$
> \forall \epsilon>0,\forall \mathbf x\in J_D,|F(\mathbf x)-f(\mathbf x)|<\epsilon
> $$

é€šç”¨è¿‘ä¼¼å®šç†åœ¨å®æ•°ç©ºé—´ $\mathbb R^D$ ä¸­çš„æœ‰ç•Œé—­é›†ä¸Šä¾ç„¶æˆç«‹ã€‚å¯¹äºå…·æœ‰<u>çº¿æ€§è¾“å‡ºå±‚å’Œè‡³å°‘ä¸€ä¸ªä½¿ç”¨â€œæŒ¤å‹â€æ€§è´¨çš„æ¿€æ´»å‡½æ•°ï¼ˆæŒ‡åƒ Sigmoid å‡½æ•°çš„æœ‰ç•Œå‡½æ•°ï¼‰çš„éšè—å±‚</u>ç»„æˆçš„å‰é¦ˆç¥ç»ç½‘ç»œï¼Œåªè¦å…¶éšè—å±‚ç¥ç»å…ƒçš„æ•°é‡è¶³å¤Ÿï¼Œå®ƒå¯ä»¥ä»¥ä»»æ„çš„ç²¾åº¦æ¥è¿‘ä¼¼ä»»ä½•ä¸€ä¸ªå®šä¹‰åœ¨å®æ•°ç©ºé—´ $\mathbb R^D$ ä¸­çš„æœ‰ç•Œé—­é›†å‡½æ•°ã€‚

é€šç”¨è¿‘ä¼¼å®šç†åªæ˜¯è¯´æ˜äº†ç¥ç»ç½‘ç»œçš„è®¡ç®—èƒ½åŠ›å¯ä»¥å»è¿‘ä¼¼ä¸€ä¸ªç»™å®šçš„è¿ç»­å‡½æ•°ï¼Œä½†å¹¶æ²¡æœ‰ç»™å‡ºå¦‚ä½•æ‰¾åˆ°è¿™æ ·ä¸€ä¸ªç½‘ç»œï¼Œä»¥åŠæ˜¯å¦æ˜¯æœ€ä¼˜çš„ã€‚

### 4.3.2 åº”ç”¨åˆ°æœºå™¨å­¦ä¹ 

åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œè¾“å…¥æ ·æœ¬çš„ç‰¹å¾å¯¹åˆ†ç±»å™¨çš„å½±å“å¾ˆå¤§ã€‚è¦å–å¾—å¥½çš„åˆ†ç±»æ•ˆæœï¼Œéœ€è¦å°†æ ·æœ¬çš„åŸå§‹ç‰¹å¾å‘é‡ $\mathbf x$ è½¬æ¢åˆ°æ›´æœ‰æ•ˆçš„ç‰¹å¾å‘é‡ $\phi(\mathbf x)$ï¼Œè¿™ä¸ªè¿‡ç¨‹å«ä½œç‰¹å¾æŠ½å–ã€‚

ç»™å®šä¸€ä¸ªè®­ç»ƒæ ·æœ¬ $(\mathbf x,y)$ï¼Œå…ˆåˆ©ç”¨å¤šå±‚å‰é¦ˆç¥ç»ç½‘ç»œå°† $\mathbf x$ æ˜ å°„åˆ° $\phi(\mathbf x)$ï¼Œç„¶åå†å°† $\phi(\mathbf x)$ è¾“å…¥åˆ°åˆ†ç±»å™¨ $g(\cdot)$ï¼Œå³
$$
\hat{y}=g(\phi(\mathbf x);\theta)
$$
å…¶ä¸­ $g(\cdot)$ ä¸ºçº¿æ€§æˆ–éçº¿æ€§çš„åˆ†ç±»å™¨ï¼Œ$\theta$ ä¸ºåˆ†ç±»å™¨ $g(\cdot)$ çš„å‚æ•°ï¼Œ$\hat{y}$ ä¸ºåˆ†ç±»å™¨çš„è¾“å‡ºã€‚

### 4.3.3 å‚æ•°å­¦ä¹ 

å¦‚æœé‡‡ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œå¯¹äºæ ·æœ¬ $(\mathbf x,y)$ï¼Œå…¶æŸå¤±å‡½æ•°ä¸º

$$
\mathcal L(\mathbf y,\hat{\mathbf y})=-\mathbf y^T\log\hat{\mathbf y}
$$
å…¶ä¸­ $\hat{\mathbf y}\in\{0,1\}^C$ ä¸ºæ ‡ç­¾ $y$ å¯¹åº”çš„ one-hot å‘é‡è¡¨ç¤ºã€‚

ç»™å®šè®­ç»ƒé›†ä¸º $\mathcal D=\{(\mathbf x^{(n)},y^{(n)})\}_{n=1}^{N}$ï¼Œå°†æ¯ä¸ªæ ·æœ¬ $\mathbf x^{(n)}$ è¾“å…¥ç»™å‰é¦ˆç¥ç»ç½‘ç»œï¼Œå¾—åˆ°ç½‘ç»œè¾“å‡ºä¸º $y^{(n)}$ï¼Œå…¶åœ¨æ•°æ®é›†ğ’Ÿ ä¸Šçš„ç»“æ„åŒ–é£é™©å‡½æ•°ä¸º

$$
\mathcal R(W,\mathbf b)=\frac{1}{N}\sum_{n=1}^{n}\mathcal L(\mathbf y^{(n)},\hat{\mathbf y}^{(n)})+\frac{1}{2}\lambda\|W\|^2_F
$$
å…¶ä¸­ $W$ å’Œ $\mathbf b$ åˆ†åˆ«è¡¨ç¤ºç½‘ç»œä¸­æ‰€æœ‰çš„æƒé‡çŸ©é˜µå’Œåç½®å‘é‡ï¼›$\|W\|^2_F$ æ˜¯æ­£åˆ™åŒ–é¡¹ï¼Œç”¨æ¥é˜²æ­¢è¿‡æ‹Ÿåˆï¼›$\lambda$ ä¸ºè¶…å‚æ•°ï¼$\lambda$ è¶Šå¤§ï¼Œ$W$ è¶Šæ¥è¿‘äº $0$ã€‚$\|W\|^2_F$ ä¸€èˆ¬ä½¿ç”¨ Frobenius èŒƒæ•°ï¼š
$$
\|W\|^2_F=\sum_{l=1}^{L}\sum_{i=1}^{M_l}\sum_{j=1}^{M_{l-1}}(w_{ij}^{(l)})^2
$$
æœ‰äº†å­¦ä¹ å‡†åˆ™å’Œè®­ç»ƒæ ·æœ¬ï¼Œç½‘ç»œå‚æ•°å¯ä»¥é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•æ¥è¿›è¡Œå­¦ä¹ ã€‚åœ¨æ¢¯åº¦ä¸‹é™æ–¹æ³•çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œç¬¬ğ‘™ å±‚çš„å‚æ•° $W^{(l)}$ å’Œ $\mathbf b^{(l)}$ å‚æ•°æ›´æ–°æ–¹å¼ä¸ºï¼š
$$
\begin{align*}
W^{(l)}&\leftarrow W^{(l)}-\alpha\frac{\partial\mathcal R(W,\mathbf b)}{\partial W^{(l)}}\\
&=W^{(l)}-\alpha(\frac{1}{N}\sum_{n=1}^{N}\frac{\partial\mathcal L(\mathbf y^{(n)},\hat{\mathbf y}^{(n)})}{\partial W^{(l)}})+\lambda W^{(l)}\\
\mathbf b^{(l)}&\leftarrow\mathbf b^{(l)}-\alpha\frac{\partial\mathcal R(W,\mathbf b)}{\partial\mathbf b^{(l)}}\\
&=\mathbf b^{(l)}-\alpha(\frac{1}{N}\sum_{n=1}^{N}\frac{\partial\mathcal L(\mathbf y^{(n)},\hat{\mathbf y}^{(n)})}{\partial\mathbf b^{(l)}})\\
\end{align*}
$$

$\alpha$ ä¸ºå­¦ä¹ ç‡ã€‚

åœ¨ç¥ç»ç½‘ç»œçš„è®­ç»ƒä¸­ç»å¸¸ä½¿ç”¨åå‘ä¼ æ’­ç®—æ³•æ¥é«˜æ•ˆåœ°è®¡ç®—æ¢¯åº¦ã€‚

## 4.4 åå‘ä¼ æ’­ç®—æ³• Back-Propagation

éœ€è¦è®¡ç®—æŸå¤±å‡½æ•°å¯¹äºæ¯ä¸€å±‚æ¯ä¸ªå‚æ•°çš„åå¯¼æ•°ã€‚

å¯¹ç¬¬ $l$ å±‚çš„å‚æ•° $W^{(l)}$ å’Œ $\mathbf b^{(l)}$ è®¡ç®—åå¯¼æ•°ï¼Œå…ˆè®¡ç®—æ¯ä¸€ä¸ªå…ƒç´ çš„åå¯¼æ•°ï¼š
$$
\begin{align*}
\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial w^{(l)}_{ij}}&=\frac{\partial\mathbf z^{(l)}}{\partial w^{(l)}_{ij}}\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial \mathbf z^{(l)}}\\
\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial \mathbf b^{(l)}}&=\frac{\partial\mathbf z^{(l)}}{\partial \mathbf b^{(l)}}\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial \mathbf z^{(l)}}\\
\end{align*}
$$
å…¶ä¸­ï¼Œ$\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial \mathbf z^{(l)}}$ æ˜¯ç›®æ ‡å‡½æ•°å…³äºç¬¬ $l$ å±‚çš„ç¥ç»å…ƒå‡€è¾“å…¥çš„åå¯¼æ•°ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦è®¡ç®— $3$ ä¸ªåå¯¼æ•°ï¼š
$$
\begin{align*}
\frac{\partial\mathbf z^{(l)}}{\partial w^{(l)}_{ij}}&=[\frac{\partial z_1^{(l)}}{\partial w^{(l)}_{ij}},\dots,\frac{\partial z_i^{(l)}}{\partial w^{(l)}_{ij}},\dots,\frac{\partial z_{M_l}^{(l)}}{\partial w^{(l)}_{ij}}]\\
&=[0,\dots,\frac{\partial (\mathbf w_i^{(l)}\mathbf a^{(l-1)}+b_i^{(l)})}{\partial w^{(l)}_{ij}},\dots,0]\\
&=[0,\dots,a_j^{(l-1)},\dots,0]\\
&=\mathbb I_i(a_j^{(l-1)})
\end{align*}
$$
å³ï¼Œè¦æ±‚å¾— $\mathbf z^{(l)}$ å…³äºçš„ $W^{(l)}$ ç¬¬ $i$ è¡Œç¬¬ $j$ åˆ—å…ƒç´ çš„åå¯¼æ•°ï¼Œå±•å¼€ $\mathbf z^{(l)}$ å¯å‘ç°ä»…æœ‰ $\mathbf z^{(l)}$ çš„ç¬¬ $i$ ä¸ªå…ƒç´  $z_{i}^{(l)}$ ä¸ $w_{ij}^{(l)}$ æœ‰è”ç³»ï¼Œå±•å¼€ $z_{i}^{(l)}=\mathbf w_i^{(l)}\mathbf a^{(l-1)}+b_i^{(l)}$ å¯å¾—åˆ°ä¸ $w_{ij}^{(l)}$ ç›¸å…³çš„é¡¹ä¸º $a_j^{(l-1)}$ï¼Œåœ¨ç¬¬ $i$ ä¸ªä½ç½®ã€‚

$$
\begin{align*}
\frac{\partial\mathbf z^{(l)}}{\partial \mathbf b^{(l)}}&=\frac{\partial(W^{(l)}\mathbf a^{(l-1)}+\mathbf b^{(l)})}{\partial \mathbf b^{(l)}}\\
&=I_{M_l}\\
\end{align*}
$$
$I_{M_l}$ ä¸º $M_l\times M_l$ çš„å•ä½çŸ©é˜µã€‚

$$
\begin{align*}
\delta^{(l)}\triangleq\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial \mathbf z^{(l)}}&=\frac{\partial\mathbf z^{(l+1)}}{\partial \mathbf z^{(l)}}\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial\mathbf z^{(l+1)}}\\
&=\frac{\partial(\mathbf W^{(l+1)}\mathbf a^{(l)}+\mathbf b^{(l+1)})}{\partial \mathbf z^{(l)}}\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial\mathbf z^{(l+1)}}\\
&=\frac{\partial(\mathbf W^{(l+1)}f_l(\mathbf z^{(l)})+\mathbf b^{(l+1)})}{\partial \mathbf z^{(l)}}\cdot\delta^{(l+1)}\\
&=\frac{\partial(f_l(\mathbf z^{(l)}))}{\partial \mathbf z^{(l)}}\cdot(\mathbf W^{(l+1)})^T\cdot\delta^{(l+1)}\\
&=\text{diag}(f_l(\mathbf z^{(l)}))(\mathbf W^{(l+1)})^T\delta^{(l+1)}\\
\mathbb R^{M_l\times1}&=\mathbb R^{M_l\times M_l}\mathbb R^{M_l\times M_{l+1}}\mathbb R^{M_{l+1}\times1}
\end{align*}
$$

$f_l$ æ˜¯æŒ‰ä½è®¡ç®—çš„å‡½æ•°ï¼Œæ±‚å¯¼å¾—åˆ°ä¸€ä¸ªå¯¹è§’çŸ©é˜µã€‚

åå‘ä¼ æ’­ç®—æ³•çš„å«ä¹‰æ˜¯ï¼šç¬¬ $l$ å±‚çš„ä¸€ä¸ªç¥ç»å…ƒçš„è¯¯å·®é¡¹ï¼ˆæˆ–æ•æ„Ÿæ€§ï¼‰æ˜¯æ‰€æœ‰ä¸è¯¥ç¥ç»å…ƒç›¸è¿çš„ç¬¬ $l+1$ å±‚çš„ç¥ç»å…ƒçš„è¯¯å·®é¡¹çš„<u>æƒé‡å’Œ</u>ï¼Œç„¶åå†<u>ä¹˜ä¸Šè¯¥ç¥ç»å…ƒæ¿€æ´»å‡½æ•°çš„æ¢¯åº¦</u>ã€‚

å› æ­¤ï¼š
$$
\begin{align*}
\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial w^{(l)}_{ij}}&=\frac{\partial\mathbf z^{(l)}}{\partial w^{(l)}_{ij}}\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial \mathbf z^{(l)}}\\
&=\mathbb I_i(a_j^{(l-1)})\delta^{(l)}\\
&=a_j^{(l-1)}\delta_i^{(l)}\\
&=\delta_i^{(l)}a_j^{(l-1)}\\
[\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial\mathbf w^{(l)}}]_{ij}&=[\delta^{(l)}(\mathbf a^{(l-1)})^T]_{ij}\\
\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial\mathbf w^{(l)}}&=\delta^{(l)}(\mathbf a^{(l-1)})^T
\end{align*}
$$

$$
\begin{align*}
\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial \mathbf b^{(l)}}&=\frac{\partial\mathbf z^{(l)}}{\partial \mathbf b^{(l)}}\frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial \mathbf z^{(l)}}\\
&=I_{M_l}\delta^{(l)}\\
&=\delta^{(l)}\\
\end{align*}
$$

å› æ­¤ï¼Œåå‘ä¼ æ’­çš„è®¡ç®—æ­¥éª¤æ˜¯ï¼š

> 1. ä» $N$ ä¸ªæ ·æœ¬ä¸­é€‰å–ä¸€ä¸ªæ ·æœ¬ $(\mathbf x^{(n)}, y^{(n)})$ã€‚
>
> 2. ä¾æ¬¡è®¡ç®—å„å±‚å‡€è¾“å…¥ $\mathbf z^{(l)}$ å’Œæ¿€æ´»å€¼ $\mathbf a^{(l)}$ã€‚
>
> 3. è®¡ç®—æœ€åä¸€å±‚çš„è¯¯å·®å€¼ $\delta^{(L)}$ å¹¶ä¸”ç”¨ $\delta^{(l)}=\text{diag}(f_l(\mathbf z^{(l)}))(\mathbf W^{(l+1)})^T\delta^{(l+1)}$ ä¾æ¬¡è®¡ç®—å„å±‚è¯¯å·®å€¼ã€‚
>
> 4. è®¡ç®—å‚æ•°æ¢¯åº¦ï¼š
>    $$
>    \frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial\mathbf w^{(l)}}=\delta^{(l)}(\mathbf a^{(l-1)})^T\\
>    \frac{\partial\mathcal L(\mathbf y,\hat{\mathbf y})}{\partial \mathbf b^{(l)}}=\delta^{(l)}\\
>    $$
>
> 5. $N$ æ¬¡è®¡ç®—åæ›´æ–°å‚æ•°ï¼š
>    $$
>    W^{(l)}\leftarrow W^{(l)}-\alpha(\frac{1}{N}\sum_{n=1}^{N}\frac{\partial\mathcal L(\mathbf y^{(n)},\hat{\mathbf y}^{(n)})}{\partial W^{(l)}})+\lambda W^{(l)}\\
>    \mathbf b^{(l)}\leftarrow\mathbf b^{(l)}-\alpha(\frac{1}{N}\sum_{n=1}^{N}\frac{\partial\mathcal L(\mathbf y^{(n)},\hat{\mathbf y}^{(n)})}{\partial\mathbf b^{(l)}})\\
>    $$
>    

## 4.5 è‡ªåŠ¨æ¢¯åº¦è®¡ç®— Automatic Gradient

è‡ªåŠ¨è®¡ç®—æ¢¯åº¦çš„æ–¹æ³•å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼šæ•°å€¼å¾®åˆ†ã€ç¬¦å·å¾®åˆ†å’Œè‡ªåŠ¨å¾®åˆ†ã€‚

### 4.5.1 æ•°å€¼å¾®åˆ† Numerical Differentiation

è¦è®¡ç®—å‡½æ•° $f(x)$ åœ¨ç‚¹ $x$ çš„å¯¼æ•°ï¼Œå¯ä»¥å¯¹ $x$ åŠ ä¸Šä¸€ä¸ªå¾ˆå°‘çš„éé›¶çš„æ‰°åŠ¨ $\Delta x$ï¼Œé€šè¿‡ä¸Šè¿°å®šä¹‰æ¥ç›´æ¥è®¡ç®—å‡½æ•° $f(x)$ çš„æ¢¯åº¦ã€‚æ•°å€¼å¾®åˆ†æ–¹æ³•éå¸¸å®¹æ˜“å®ç°ï¼Œä½†æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„æ‰°åŠ¨ $\Delta x$ å´ååˆ†å›°éš¾ã€‚å¦‚æœ $\Delta x$ è¿‡å°ï¼Œä¼šå¼•èµ·æ•°å€¼è®¡ç®—é—®é¢˜ï¼Œæ¯”å¦‚<u>èˆå…¥è¯¯å·®</u>ï¼›å¦‚æœ $\Delta x$ è¿‡å¤§ï¼Œä¼šå¢åŠ <u>æˆªæ–­è¯¯å·®</u>ï¼Œä½¿å¾—å¯¼æ•°è®¡ç®—ä¸å‡†ç¡®ã€‚å› æ­¤ï¼Œæ•°å€¼å¾®åˆ†çš„å®ç”¨æ€§æ¯”è¾ƒå·®ã€‚

åœ¨å®é™…åº”ç”¨ï¼Œç»å¸¸ä½¿ç”¨ä¸‹é¢å…¬å¼æ¥è®¡ç®—æ¢¯åº¦ï¼Œå¯ä»¥å‡å°‘æˆªæ–­è¯¯å·®ã€‚
$$
f'(x)=\lim_{\Delta x\to0}\frac{f(x+\Delta x)-f(x-\Delta x)}{2\Delta x}
$$

### 4.5.2 ç¬¦å·å¾®åˆ† Symbolic Differentiation

ç¬¦å·å¾®åˆ†æ˜¯ä¸€ç§åŸºäºç¬¦å·è®¡ç®—çš„è‡ªåŠ¨æ±‚å¯¼æ–¹æ³•ã€‚ç¬¦å·è®¡ç®—çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ç¬¦å·è®¡ç®—å’Œå¹³å°æ— å…³ï¼Œå¯ä»¥åœ¨ CPU æˆ– GPU ä¸Šè¿è¡Œã€‚ç¼–è¯‘æ—¶é—´è¾ƒé•¿ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¾ªç¯ï¼Œéœ€è¦å¾ˆé•¿æ—¶é—´è¿›è¡Œç¼–è¯‘ã€‚ä¸ºäº†è¿›è¡Œç¬¦å·å¾®åˆ†ï¼Œä¸€èˆ¬éœ€è¦è®¾è®¡ä¸€ç§ä¸“é—¨çš„è¯­è¨€æ¥è¡¨ç¤ºæ•°å­¦è¡¨è¾¾å¼ï¼Œå¹¶ä¸”è¦å¯¹å˜é‡ï¼ˆç¬¦å·ï¼‰è¿›è¡Œé¢„å…ˆå£°æ˜ã€‚

### 4.5.3 è‡ªåŠ¨å¾®åˆ† Automatic Differentiation

ç¬¦å·å¾®åˆ†çš„å¤„ç†å¯¹è±¡æ˜¯æ•°å­¦è¡¨è¾¾å¼ï¼Œè€Œè‡ªåŠ¨å¾®åˆ†çš„å¤„ç†å¯¹è±¡æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–ä¸€æ®µç¨‹åºã€‚æ˜¯æ‰€æœ‰çš„æ•°å€¼è®¡ç®—å¯ä»¥åˆ†è§£ä¸ºä¸€äº›åŸºæœ¬æ“ä½œï¼ŒåŒ…å«å››åˆ™è¿ç®—å’Œä¸€äº›åˆç­‰å‡½æ•°ç­‰ï¼Œç„¶ååˆ©ç”¨é“¾å¼æ³•åˆ™æ¥è‡ªåŠ¨è®¡ç®—ä¸€ä¸ªå¤åˆå‡½æ•°çš„æ¢¯åº¦ã€‚

å°†å¤åˆå‡½æ•°åˆ†è§£ä¸ºä¸€ç³»åˆ—çš„åŸºæœ¬æ“ä½œï¼Œå¹¶æ„æˆä¸€ä¸ª**è®¡ç®—å›¾**ï¼ˆComputational Graphï¼‰ã€‚å¦‚æœå‡½æ•°å’Œå‚æ•°ä¹‹é—´æœ‰å¤šæ¡è·¯å¾„ï¼Œå¯ä»¥å°†è¿™å¤šæ¡è·¯å¾„ä¸Šçš„å¯¼æ•°å†è¿›è¡Œç›¸åŠ ï¼Œå¾—åˆ°æœ€ç»ˆçš„æ¢¯åº¦ã€‚éœ€è¦è®¡ç®—æ¯ä¸ªèŠ‚ç‚¹çš„å‡½æ•°å€¼ï¼Œå¯¼æ•°å€¼ã€‚

è‡ªåŠ¨å¾®åˆ†å¯ä»¥åˆ†ä¸ºä¸¤ç§æ¨¡å¼ï¼šå‰å‘æ¨¡å¼å’Œåå‘æ¨¡å¼ã€‚åå‘æ¨¡å¼å’Œåå‘ä¼ æ’­çš„è®¡ç®—æ¢¯åº¦çš„æ–¹å¼ç›¸åŒã€‚

è®¡ç®—å›¾æŒ‰æ„å»ºæ–¹å¼å¯ä»¥åˆ†ä¸ºé™æ€è®¡ç®—å›¾ï¼ˆStatic Computational Graphï¼‰å’ŒåŠ¨æ€è®¡ç®—å›¾ï¼ˆDynamic Computational Graphï¼‰ã€‚é™æ€è®¡ç®—å›¾æ˜¯åœ¨ç¼–è¯‘æ—¶æ„å»ºè®¡ç®—å›¾ï¼Œè®¡ç®—å›¾æ„å»ºå¥½ä¹‹ååœ¨ç¨‹åºè¿è¡Œæ—¶ä¸èƒ½æ”¹å˜ï¼Œè€ŒåŠ¨æ€è®¡ç®—å›¾æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€æ„å»ºã€‚é™æ€è®¡ç®—å›¾åœ¨æ„å»ºæ—¶å¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶è¡Œèƒ½åŠ›å¼ºï¼Œä½†çµæ´»æ€§æ¯”è¾ƒå·®ã€‚åŠ¨æ€è®¡ç®—å›¾åˆ™ä¸å®¹æ˜“ä¼˜åŒ–ï¼Œå½“ä¸åŒè¾“å…¥çš„ç½‘ç»œç»“æ„ä¸ä¸€è‡´æ—¶ï¼Œéš¾ä»¥å¹¶è¡Œè®¡ç®—ï¼Œä½†æ˜¯çµæ´»æ€§æ¯”è¾ƒé«˜ã€‚

## 4.6 ä¼˜åŒ–é—®é¢˜ Optimization

### 4.6.1 éå‡¸ä¼˜åŒ–é—®é¢˜ Non-Convex Optimization

ç¥ç»ç½‘ç»œçš„ä¼˜åŒ–é—®é¢˜æ˜¯ä¸€ä¸ªéå‡¸ä¼˜åŒ–é—®é¢˜ã€‚

### 4.6.2 æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ Gradient Disappearing

ç”±äºæŸäº›æ¿€æ´»å‡½æ•°ï¼ˆSigmoid å‹å‡½æ•°ï¼‰çš„é¥±å’Œæ€§ï¼Œé¥±å’ŒåŒºçš„å¯¼æ•°æ›´æ˜¯æ¥è¿‘äº $0$ï¼è¿™æ ·ï¼Œè¯¯å·®ç»è¿‡æ¯ä¸€å±‚ä¼ é€’éƒ½ä¼šä¸æ–­è¡°å‡ã€‚å½“ç½‘ç»œå±‚æ•°å¾ˆæ·±æ—¶ï¼Œæ¢¯åº¦å°±ä¼šä¸åœè¡°å‡ï¼Œç”šè‡³æ¶ˆå¤±ï¼Œä½¿å¾—æ•´ä¸ªç½‘ç»œå¾ˆéš¾è®­ç»ƒã€‚è¿™å°±æ˜¯æ‰€è°“çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼ˆVanishing Gradient Problemï¼‰ï¼Œä¹Ÿç§°ä¸ºæ¢¯åº¦å¼¥æ•£é—®é¢˜ã€‚

åœ¨æ·±åº¦ç¥ç»ç½‘ç»œä¸­ï¼Œå‡è½»æ¢¯åº¦æ¶ˆå¤±é—®é¢˜çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ã€‚ä¸€ç§ç®€å•æœ‰æ•ˆçš„æ–¹å¼æ˜¯ä½¿ç”¨å¯¼æ•°æ¯”è¾ƒå¤§çš„æ¿€æ´»å‡½æ•°ï¼Œæ¯”å¦‚ReLUç­‰ã€‚





## ä¹ é¢˜

### ä¹ é¢˜4-1
å¯¹äºä¸€ä¸ªç¥ç»å…ƒ $\sigma(\mathbf w^T\mathbf x+\mathbf b)$ å¹¶ä½¿ç”¨æ¢¯åº¦ä¸‹é™ä¼˜åŒ–å‚æ•° $\mathbf w$ æ—¶ï¼Œå¦‚æœè¾“å…¥ $\mathbf x$ æ’å¤§äº $0$ï¼Œå…¶æ”¶æ•›é€Ÿåº¦ä¼šæ¯”é›¶å‡å€¼åŒ–çš„è¾“å…¥æ›´æ…¢ã€‚
>   
### ä¹ é¢˜4-2
è¯•è®¾è®¡ä¸€ä¸ªå‰é¦ˆç¥ç»ç½‘ç»œæ¥è§£å†³å¼‚æˆ–é—®é¢˜ï¼Œè¦æ±‚è¯¥å‰é¦ˆç¥ç»ç½‘ç»œå…·æœ‰ä¸¤ä¸ªéšè—ç¥ç»å…ƒå’Œä¸€ä¸ªè¾“å‡ºç¥ç»å…ƒï¼Œå¹¶ä½¿ç”¨ ReLU ä½œä¸ºæ¿€æ´»å‡½æ•°ã€‚

```
x = torch.tensor([[0, 0], [0, 1], [1, 0], [1, 1]])
y = torch.tensor([0, 1, 1, 0])
net = nn.Sequential(
    nn.Linear(2, 2),
    nn.ReLU(),
    nn.Linear(2, 1)
)
optimizer = torch.optim.Adam(net.parameters(), or=0.05)
loss_fn = nn.MSELoss()
```

